# Branch Consolidation & Workflow Fix

## Summary of Changes

### Problems Fixed:
1. ✅ **Multiple deployment branches** - `master`, `main`, and `development` all triggering GitHub Pages deployments
2. ✅ **Merge conflicts** - Generated `docs/` folder causing repeated merge conflicts
3. ✅ **Undefined default branch** - Repository HEAD not clearly set

### Solutions Implemented:

#### 1. GitHub Actions Workflow Update
**File:** `.github/workflows/deploy-gh-pages.yml`
- **Changed:** Workflow now triggers **only on `main` branch** (was triggering on `master`, `main`, and `development`)
- **Benefit:** Single source of truth for deployments, no conflicting builds

#### 2. Branch Consolidation
- **Deleted:** `master` branch (both local and remote)
- **Kept:** `main` (production/deployment) and `development` (feature development)
- **Set:** `origin/main` as the default branch (visible in GitHub UI)

#### 3. Generated Files Management
**File:** `.gitignore`
- **Added:** `docs/` directory to `.gitignore`
- **Reason:** `docs/` is auto-generated by GitHub Actions workflow on each push to `main`
- **Benefit:** Prevents merge conflicts from generated static files

## Git Structure

```
main (production)
  └─ Receives automatic deployments from GitHub Actions
  └─ Deployed to GitHub Pages (docs/ folder)
  
development (feature branch)
  └─ Where developers make changes
  └─ Should be merged to main for deployment
```

## Workflow: How to Deploy

### For Developers:
1. Make changes on `development` branch
2. Test locally: `npm run dev`
3. Commit and push: `git push origin development`

### For Deployment to GitHub Pages:
1. Create a Pull Request from `development` → `main`
2. Review and merge to `main`
3. GitHub Actions automatically:
   - Runs `npm ci` (clean install)
   - Runs `npm run predeploy` (next build + export)
   - Copies output to `docs/` folder
   - Pushes to `main` branch
4. GitHub Pages serves from `docs/` folder

## Configuration Verification

✅ **GitHub Repository Settings:**
- Default branch: `main`
- GitHub Pages source: Branch `main`, folder `/docs`

✅ **Local Git Configuration:**
- `remotes/origin/HEAD` → `origin/main`
- Workflow file: Only triggers on `main` branch
- `.gitignore`: Ignores `/docs`

## Important Notes

### Don't do this:
- ❌ Push directly to `main` from local development
- ❌ Edit files in `docs/` manually (they'll be overwritten)
- ❌ Trigger builds from multiple branches

### Do this instead:
- ✅ Push to `development`
- ✅ Create PR to `main` for code review
- ✅ Let GitHub Actions handle `docs/` generation
- ✅ Let GitHub Pages serve from `docs/`

## Quick Reference Commands

```bash
# See all branches
git branch -a

# Switch to development for coding
git checkout development

# Push your work
git push origin development

# See deployment status
# Check: GitHub → Actions tab

# View deployed site
# https://vulchivijay.github.io
```

## Troubleshooting

**Q: I see merge conflicts in `docs/`**
- A: Don't manually edit `docs/`. The workflow regenerates it automatically.

**Q: GitHub Pages not updating**
- A: Check GitHub Actions tab for workflow errors. Workflow must run on `main` branch.

**Q: I need to rebuild the entire site**
- A: Run locally: `npm run predeploy`, then push to `main`.

---
**Last Updated:** November 15, 2025
**Status:** ✅ All branch conflicts resolved
