{"version":3,"sources":["turbopack:///[project]/app/kidsZone/mythologicalquizzes/QuizClient.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useMemo, useState } from \"react\";\nimport { t, detectLocale, DEFAULT_LOCALE } from \"../../../lib/i18n\";\n\ntype Options = { A: string; B: string; C: string; D: string };\ntype Question = { id: number; question: string; options: Options; answer: keyof Options };\n\nfunction sampleIndices(total: number, count: number): number[] {\n  const arr = Array.from({ length: total }, (_, i) => i);\n  for (let i = arr.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [arr[i], arr[j]] = [arr[j], arr[i]];\n  }\n  return arr.slice(0, count);\n}\n\nexport default function QuizClient() {\n  const [questionsPool, setQuestionsPool] = useState<Question[] | null>(null);\n  const [selectedIdx, setSelectedIdx] = useState<number[]>([]);\n  const [current, setCurrent] = useState(0);\n  const [answers, setAnswers] = useState<Record<number, keyof Options>>({});\n  const [finished, setFinished] = useState(false);\n  const [timeLeft, setTimeLeft] = useState(10 * 60); // 10 minutes in seconds\n  const [started, setStarted] = useState(false);\n\n  useEffect(() => {\n    let mounted = true;\n    fetch('/locales/en/questions.json')\n      .then((r) => r.json())\n      .then((data: Question[]) => {\n        if (!mounted) return;\n        setQuestionsPool(data);\n        const indices = sampleIndices(data.length, 10);\n        setSelectedIdx(indices);\n      })\n      .catch((err) => console.error('Failed to load questions', err));\n    return () => { mounted = false; };\n  }, []);\n\n  useEffect(() => {\n    if (!started || finished) return;\n    const t = setInterval(() => {\n      setTimeLeft((s) => {\n        if (s <= 1) {\n          clearInterval(t);\n          setFinished(true);\n          return 0;\n        }\n        return s - 1;\n      });\n    }, 1000);\n    return () => clearInterval(t);\n  }, [finished, started]);\n\n  const qList = useMemo(() => {\n    if (!questionsPool || selectedIdx.length === 0) return [] as Question[];\n    return selectedIdx.map((i) => questionsPool[i]);\n  }, [questionsPool, selectedIdx]);\n\n  function selectOption(opt: keyof Options) {\n    if (finished) return;\n    const qid = qList[current].id;\n    setAnswers((prev) => ({ ...prev, [qid]: opt }));\n  }\n\n  function goNext() {\n    if (current < qList.length - 1) setCurrent(current + 1);\n    else setFinished(true);\n  }\n\n  function goPrev() {\n    if (current > 0) setCurrent(current - 1);\n  }\n\n  function restart() {\n    if (!questionsPool) return;\n    const indices = sampleIndices(questionsPool.length, 10);\n    setSelectedIdx(indices);\n    setAnswers({});\n    setCurrent(0);\n    setFinished(false);\n    setTimeLeft(10 * 60);\n    setStarted(false);\n  }\n\n  const score = useMemo(() => {\n    if (!qList || qList.length === 0) return 0;\n    let s = 0;\n    for (const q of qList) {\n      const a = answers[q.id];\n      if (a && a === q.answer) s++;\n    }\n    return s;\n  }, [answers, qList]);\n\n  function fmtTime(sec: number) {\n    const m = Math.floor(sec / 60).toString().padStart(2, '0');\n    const s = (sec % 60).toString().padStart(2, '0');\n    return `${m}:${s}`;\n  }\n\n  const loc = detectLocale() || DEFAULT_LOCALE;\n  if (!questionsPool) return <div>{t('quiz.loading', loc)}</div>;\n  if (qList.length === 0) return <div>{t('quiz.preparing', loc)}</div>;\n\n  if (!started) {\n    return (\n      <div>\n        <h2>{t('quiz.readyTitle', loc)}</h2>\n        <p>{t('quiz.readyDescription', loc).replace('{count}', String(qList.length)).replace('{time}', fmtTime(timeLeft))}</p>\n        <div>\n          <button onClick={() => setStarted(true)}>{t('quiz.start', loc)}</button>\n          <button onClick={restart}>{t('quiz.shuffle', loc)}</button>\n        </div>\n      </div>\n    );\n  }\n\n  if (finished) {\n    return (\n      <div>\n        <h3>{t('quiz.resultsTitle', loc) || t('quiz.resultsTitle', loc)}</h3>\n        <div>{t('quiz.yourScore', loc)} <strong>{score}</strong> / {qList.length}</div>\n        <div>{t('quiz.timeTaken', loc)} {fmtTime(10 * 60 - timeLeft)}</div>\n        <div>\n          {qList.map((q, idx) => (\n            <div key={q.id}>\n              <div>{idx + 1}. {q.question}</div>\n              <div>\n                {(['A', 'B', 'C', 'D'] as (keyof Options)[]).map((k) => {\n                  const correct = k === q.answer;\n                  const chosen = answers[q.id] === k;\n                  return (\n                    <div key={k}>\n                      <strong>{k}.</strong> {q.options[k]} {correct ? ' (Correct)' : chosen ? ' (Your choice)' : ''}\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n          ))}\n        </div>\n        <div>\n          <button onClick={restart}>{t('quiz.restart', loc)}</button>\n        </div>\n      </div>\n    );\n  }\n\n  const q = qList[current];\n\n  return (\n    <div>\n      <div>\n        <div>{t('quiz.questionCounter', loc).replace('{current}', String(current + 1)).replace('{total}', String(qList.length))}</div>\n        <div>{t('quiz.timeLeftLabel', loc)} {fmtTime(timeLeft)}</div>\n      </div>\n\n      <div>\n        <div>{q.question}</div>\n        <div>\n          {(['A', 'B', 'C', 'D'] as (keyof Options)[]).map((k) => (\n            <button\n              key={k}\n              onClick={() => selectOption(k)}\n            >\n              <strong>{k}.</strong> {q.options[k]}\n            </button>\n          ))}\n        </div>\n\n        <div>\n          <div>\n            <button onClick={goPrev} disabled={current === 0}>{t('quiz.previous', loc)}</button>\n            <button onClick={goNext}>{current < qList.length - 1 ? t('quiz.next', loc) : t('quiz.finish', loc)}</button>\n          </div>\n          <div>{t('quiz.answered', loc).replace('{answered}', String(Object.keys(answers).length)).replace('{total}', String(qList.length))}</div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"wJACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MAKA,SAAS,EAAc,CAAa,CAAE,CAAa,EACjD,IAAM,EAAM,MAAM,IAAI,CAAC,CAAE,OAAQ,CAAM,EAAG,CAAC,EAAG,IAAM,GACpD,IAAK,IAAI,EAAI,EAAI,MAAM,CAAG,EAAG,EAAI,EAAG,IAAK,CACvC,IAAM,EAAI,KAAK,KAAK,CAAC,KAAK,MAAM,IAAM,CAAD,EAAK,CAAC,CAC3C,EAAC,CAAG,CAAC,EAAE,CAAE,CAAG,CAAC,EAAE,CAAC,CAAG,CAAC,CAAG,CAAC,EAAE,CAAE,CAAG,CAAC,EAAE,CAAC,AACrC,CACA,OAAO,EAAI,KAAK,CAAC,EAAG,EACtB,CAEe,SAAS,IACtB,GAAM,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAoB,MAChE,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAW,EAAE,EACrD,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GACjC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgC,CAAC,GACjE,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACnC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,KAAK,AACxC,CAAC,EAAS,EADmC,AACxB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAEvC,CAAA,EAAA,CAH2E,CAG3E,SAAA,AAAS,EAAC,KACR,IAAI,GAAU,EAUd,OATA,MAAM,8BACH,IAAI,CAAC,AAAC,GAAM,EAAE,IAAI,IAClB,IAAI,CAAE,AAAD,IACC,AAAL,IAAI,AACJ,EAAiB,GADH,AAGd,EADgB,EAAc,EAAK,MAAM,CAAE,EAC5B,GACjB,GACC,KAAK,CAAC,AAAC,GAAQ,QAAQ,KAAK,CAAC,2BAA4B,IACrD,KAAQ,GAAU,CAAO,CAClC,EAAG,EAAE,EAEL,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,GAAI,CAAC,GAAW,EAAU,OAC1B,IAAM,EAAI,YAAY,KACpB,EAAY,AAAC,GACX,AAAI,GAAK,GAAG,AACV,cAAc,GACd,GAAY,GACL,GAEF,EAAI,EAEf,EAAG,KACH,MAAO,IAAM,cAAc,EAC7B,EAAG,CAAC,EAAU,EAAQ,EAEtB,IAAM,EAAQ,CAAA,EAAA,EAAA,OAAO,AAAP,EAAQ,IACpB,AAAI,AAAC,GAAwC,GAAG,CAA1B,EAAY,MAAM,CACjC,EAAY,GAAG,CAAC,AAAC,GAAM,CAAa,CAAC,EAAE,EADS,EAAE,CAExD,CAAC,EAAe,EAAY,EAiB/B,SAAS,IACP,AAAK,IAAD,AAEJ,EADgB,EAAc,EAAc,KADxB,CAC8B,CAAE,EACrC,GACf,EAAW,CAAC,GACZ,EAAW,GACX,GAAY,GACZ,EAAY,KAAK,AACjB,GAAW,GACb,CAEA,IAAM,EAAQ,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KACpB,GAAI,CAAC,GAA0B,AAAjB,MAAM,MAAM,CAAQ,OAAO,EACzC,IAAI,EAAI,EACR,IAAK,IAAM,KAAK,EAAO,CACrB,IAAM,EAAI,CAAO,CAAC,EAAE,EAAE,CAAC,CACnB,GAAK,IAAM,EAAE,MAAM,EAAE,GAC3B,CACA,OAAO,CACT,EAAG,CAAC,EAAS,EAAM,EAEnB,SAAS,EAAQ,CAAW,EAC1B,IAAM,EAAI,KAAK,KAAK,CAAC,EAAM,IAAI,QAAQ,GAAG,QAAQ,CAAC,EAAG,KAChD,EAAI,CAAC,EAAM,EAAA,CAAE,CAAE,QAAQ,GAAG,QAAQ,CAAC,EAAG,KAC5C,MAAO,CAAA,EAAG,EAAE,CAAC,EAAE,EAAA,CAAG,AACpB,CAEA,IAAM,EAAM,CAAA,EAAA,EAAA,YAAA,AAAY,KAAM,EAAA,cAAc,CAC5C,GAAI,CAAC,EAAe,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAK,CAAA,EAAA,EAAA,CAAC,AAAD,EAAE,eAAgB,KACnD,GAAqB,IAAjB,EAAM,MAAM,CAAQ,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAK,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,iBAAkB,KAEzD,GAAI,CAAC,EACH,MACE,CAAA,AAFU,EAEV,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAI,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,kBAAmB,KAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAG,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,wBAAyB,GAAK,OAAO,CAAC,UAAW,OAAO,EAAM,MAAM,GAAG,OAAO,CAAC,SAAU,EAAQ,MACvG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,QAAS,IAAM,GAAW,YAAQ,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,aAAc,KAC1D,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,QAAS,WAAU,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,eAAgB,WAMrD,GAAI,EACF,MACE,CAAA,CAFU,CAEV,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAI,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,oBAAqB,IAAQ,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,oBAAqB,KAC3D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WAAK,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,iBAAkB,GAAK,IAAC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAQ,IAAe,MAAI,EAAM,MAAM,IACxE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WAAK,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,iBAAkB,GAAK,IAAE,EAAQ,IAAU,CAAL,KAC9C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UACE,EAAM,GAAG,CAAC,CAAC,EAAG,IACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WAAK,EAAM,EAAE,KAAG,EAAE,QAAQ,IAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UACG,CAAC,IAAK,IAAK,IAAK,IAAI,CAAuB,GAAG,CAAC,AAAC,IAChD,IAAM,EAAU,IAAM,EAAE,MAAM,CACxB,EAAS,CAAO,CAAC,EAAE,EAAE,CAAC,GAAK,EACjC,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,WAAQ,EAAE,OAAU,IAAE,EAAE,OAAO,CAAC,EAAE,CAAC,IAAE,EAAU,aAAe,EAAS,iBAAmB,KADnF,EAId,OAXM,EAAE,EAAE,KAgBlB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,QAAS,WAAU,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,eAAgB,UAMrD,IAAM,EAAI,CAAK,CAAC,EAAQ,CAExB,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAK,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,uBAAwB,GAAK,OAAO,CAAC,YAAa,OAAO,EAAU,IAAI,OAAO,CAAC,UAAW,OAAO,EAAM,MAAM,KACrH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WAAK,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,qBAAsB,GAAK,IAAE,EAAQ,SAG/C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAK,EAAE,QAAQ,GAChB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UACG,CAAC,IAAK,IAAK,IAAK,IAAI,CAAuB,GAAG,CAAE,AAAD,GAC/C,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAEC,QAAS,IAAM,CAzG3B,SAAS,AAAa,CAAkB,EACtC,GAAI,EAAU,OACd,IAAM,EAAM,CAAK,CAAC,EAAQ,CAAC,EAAE,CAC7B,EAAY,AAAD,IAAW,CAAE,EAAH,CAAM,CAAI,CAAE,CAAC,EAAI,CAAE,EAAI,CAAC,EAC/C,EAqGwC,aAE5B,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,WAAQ,EAAE,OAAU,IAAE,EAAE,OAAO,CAAC,EAAE,GAH9B,MAQX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,QAvGlB,CAuG2B,QAvGlB,EACH,EAAU,GAAG,EAAW,EAAU,EACxC,EAqGmC,SAAsB,IAAZ,WAAgB,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,gBAAiB,KACtE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,QA7GlB,CA6G2B,QA7GlB,EACH,EAAU,EAAM,MAAM,CAAG,EAAG,EAAW,EAAU,GAChD,EAAY,GACnB,WA0GoC,EAAU,EAAM,MAAM,CAAG,EAAI,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,YAAa,GAAO,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,cAAe,QAEhG,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAK,CAAA,EAAA,EAAA,CAAA,AAAC,EAAC,gBAAiB,GAAK,OAAO,CAAC,aAAc,OAAO,OAAO,IAAI,CAAC,GAAS,MAAM,GAAG,OAAO,CAAC,UAAW,OAAO,EAAM,MAAM,aAKzI"}